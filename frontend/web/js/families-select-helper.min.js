function FamiliesSelectHelper(e,t,i,n){var a=this;this.gridId=t,this.pjaxId=e,this.formId=i,this.selectedPjaxId=n,this.grid=$(this.gridId),this.pjax=$(this.pjaxId),this.selectedPjax=$(this.selectedPjaxId),this.inputHiddenName="Task[families][][user_id]",this.inputClassPrefix="family-",this.saveButtonSelector=".save-btn",this.init=function(){var e=$("body");e.on("beforeFilter",a.gridId,function(e){var t=$(a.gridId).find("form")[0];return e={currentTarget:t,preventDefault:function(){}},$.pjax.submit(e,a.pjaxId,{push:!1,replace:!1,timeout:!1,scrollTo:!1}),t.remove(),!1}),a.pjax.on("pjax:beforeSend",function(e,t){a.setSelectedToForm()}),a.pjax.on("pjax:end",function(e,t){var i=a.grid.find("input[name='selection_all']").is(":checked");a.grid=$(a.gridId),a.setSelectedFromForm(),i&&a.grid.find("input[name='selection_all']").prop("checked",!0)}),e.on("click",a.saveButtonSelector,function(){return a.setSelectedToForm(),a.refreshSelectedFamilies(),!0}),e.on("click",".select-all-btn",function(){return $.ajax("/task/get-all-families-from-family-search-for-task",{type:"GET",dataType:"json",data:$("#families-select-grid .filters :input").serialize(),success:function(e){a.selectedPjax.html(),0<e.length&&$.map(e,function(e){$('<input type="hidden" class="'+a.inputClassPrefix+e+'" name="'+a.inputHiddenName+'" value="'+e+'" />').appendTo(a.selectedPjax)}),a.refreshSelectedFamilies()}}),!0}),e.on("click",".select-on-check-all",function(){var t=a.grid.find("input[name='selection_all']").is(":checked");$.ajax("/task/get-all-families-from-family-search-for-task",{type:"GET",dataType:"json",data:t?$("#families-select-grid .filters :input").serialize():"",success:function(e){a.selectedPjax.html(),0<e.length&&(t?$.map(e,function(e){$('<input type="hidden" class="'+a.inputClassPrefix+e+'" name="'+a.inputHiddenName+'" value="'+e+'" />').appendTo(a.selectedPjax)}):$.map(e,function(e){a.selectedPjax.find("."+a.inputClassPrefix+e).remove()}))}})}),a.setSelectedFromForm()},this.cutLengthStrings=function(){$(".table-family-content").each(function(e,t){var i=$(t).html();50<i.length&&$(t).html(i.slice(0,50)+" ...")})},this.setSelectedToForm=function(){var e=a.grid.yiiGridView("data");e.selectionColumn&&a.grid.find("input[name='"+e.selectionColumn+"']").each(function(){var e=$(this).parent().closest("tr").data("key");$(this).is(":checked")?0===a.selectedPjax.find("."+a.inputClassPrefix+e).length&&$('<input type="hidden" class="'+a.inputClassPrefix+e+'" name="'+a.inputHiddenName+'" value="'+e+'" />').appendTo(a.selectedPjax):a.selectedPjax.find("."+a.inputClassPrefix+e).remove()})},this.setSelectedFromForm=function(){var e=a.grid.yiiGridView("data");e.selectionColumn&&a.grid.find("input[name='"+e.selectionColumn+"']").each(function(){var e=$(this).parent().closest("tr").data("key");0!=a.selectedPjax.find("."+a.inputClassPrefix+e).length&&$(this).prop("checked",!0)}),a.cutLengthStrings()},this.refreshSelectedFamilies=function(){var e={currentTarget:$(a.formId)[0],preventDefault:function(){}};$.pjax.submit(e,a.selectedPjax,{push:!1,replace:!1,timeout:!1,scrollTo:!1})},this.init()}