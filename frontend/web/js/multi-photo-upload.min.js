function PhotoUpload(c,p){var r=this;this.elementId="#"+c,this.onCompleteLoadImage=function(t,e,n,i,a,o){var s,d=$(r.elementId);d.append('<div class="col-sm-3 col-md-3 photo photo-'+(s=d.find("div.photo").length)+'"><div class="thumbnail"></div></div>');var l=d.find(".photo-"+s+" > .thumbnail");l.append('<input name="'+p+"["+s+'][photo]" value="'+t+'" type="hidden" class="photo-input" />'),l.append('<input name="'+p+"["+s+'][deleted]" value="0" type="hidden" class="photo-delete-input" />'),l.append('<input name="'+p+"["+s+'][id]" value="'+a+'" type="hidden" class="photo-id-input" />'),l.append('<input name="'+p+"["+s+'][description]" value="'+o+'" type="hidden" class="photo-description-input" />'),l.append('<a class="im" rel="gallery_'+c+'" href="'+e+'"><img src="'+e+'"/></a>'),l.append(' <div class="block caption text_review text-description-photo" data-text="">\n       <div class="text content-description" id="myShowBlock">\n<div class="text-container">\n<div class="text hidden"></div>\n<a class="cursor-pointer hidden" onclick="toggleText(this)" data-label="Скрыть">Показать полностью</a>\n</div>\n      </div>\n     </div>'),l.append('<div class="caption text-center"><a class="photo-edit" href="#"><i class="glyphicon glyphicon-pencil"></i><span class="edit-title">Добавить описание</span></a></div>'),l.append('<div class="caption text-center"><a class="photo-delete" href="#"><i class="glyphicon glyphicon-trash"></i> Удалить</a></div>')},jQuery(document).ready(function(){$("body").on("click",r.elementId+" .photo-edit",function(){var i=$(this),t=i.parents(".photo").find(".text_review").attr("data-text");i.attr("data-url");return bootbox.dialog({message:'<div class="description-container">\n <div>\n  <textarea class="description-symbols" placeholder=\'Введите описание\' maxlength="400" rows="5" style="width: 100%">'+t+"</textarea>\n </div>\n <div>\nОсталось <span class=\"count-symbols\">400</span> символов.\n </div>\n</div><script>\n  var max = $('.description-symbols').attr('maxlength');\n  var textSymbols = $('.description-container').find('.count-symbols');\n  var text = $('.description-symbols').val();\n  textSymbols.html(max - text.length);\n $('.description-symbols').on('input', function (e) {\n  var max = $(this).attr('maxlength');\n  var textSymbols = $(this).parents('.description-container').find('.count-symbols');\n  var text = $(this).val();\n  textSymbols.html(max - text.length);\n });\n<\/script>",title:"Описание",buttons:{success:{label:"Сохранить",className:"btn-primary btn-with-margin-right",callback:function(){var t=i.parents(".photo"),e=$(".description-symbols").val();if(t.find(".text_review").attr("data-text",e),t.find(".photo-description-input").val(e),t.find(".text.hidden").removeClass("hidden"),0===e.length?(t.find(".edit-title").html("Добавить описание"),t.find(".text").addClass("hidden")):t.find(".edit-title").html("Редактировать описание"),t.find(".content-description .text-container .text").html(e),t.find(".content-description .text-container .text").attr("data-text",e),0<e.length){var n=t.find(".content-description .text-container .text");n[0].clientHeight>=n[0].scrollHeight&&n[0].scrollHeight<24?t.find(".text .cursor-pointer").addClass("hidden"):t.find(".text .cursor-pointer.hidden").removeClass("hidden")}}},cancel:{label:"Отмена",className:"btn-default",callback:function(){}}}}),!1}),$("body").on("click",r.elementId+" .photo-delete",function(){var t=$(this);return bootbox.dialog({message:"Удалить это фото?",title:"Подтверждение",buttons:{success:{label:"Да",className:"btn-primary btn-with-margin-right",callback:function(){t.parents("div.thumbnail").find(".photo-delete-input").val(1),t.parents("div.photo").hide()}},cancel:{label:"Отмена",className:"btn-default",callback:function(){}}}}),!1})})}