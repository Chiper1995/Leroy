jQuery(document).ready(function(){!function(c){window.isScrolledIntoView=function(t){var e=c(t);if(0==e.length)return!0;var n=c(window),i=n.scrollTop(),a=i+n.height(),o=e.offset().top,d=o+e.height();return i<o&&d<a},window.setParentComment=function(t){var e=c(t).parent().find("span").text(),n=c(t).parent().nextAll("p:first").text();c(".parent-comment div").html("<b>"+e+"</b><br/>").append(document.createTextNode(n)),c("#comment_parent_id").val(c(t).attr("data-id")),c(".parent-comment").show()},c("body").on("click",".reply",function(){return setParentComment(this),!0}),c("body").on("click",".cancel-reply",function(){return c(".parent-comment div").html(""),c("#comment_parent_id").val(""),c(".parent-comment").hide(),!1}),c("body").on("click",".edit",function(){var n=c(this).attr("data-id"),i="#comment-"+n,t="#form-"+n,e=c(i).find("p").text(),a='<div class="media-body newnode">';return a+='<form id="form-'+n+'">',a+='<textarea id="text" class="form-control" rows="3">',a+=e,a+=" </textarea>",a+='<input type="submit" value="Сохранить">',a+="</form></div>",c(i).find(".media-body").hide(),c(i).find(".media-left").after(a),c(t).submit(function(t){t.preventDefault();var e=c(this).find("#text").val();c("#edit-comment").val(n),c("#edit-comment-form").children("input[name*='comment_text']").val(e),c("#edit-comment").click(),c(i).find(".media-body").each(function(){c(this).hasClass("newnode")?c(this).detach():(c(this).children("p").html(e),c(this).toggle())})}),!0}),c("body").on("click",".delete",function(){var e=c(this);return bootbox.dialog({message:"Удалить этот комментарий?",title:"Подтверждение",buttons:{success:{label:"Да",className:"btn-primary btn-with-margin-right",callback:function(){c("#del-comment").val(e.attr("data-id"));var t=e.parents(".media:first");t.addClass("deleting"),setTimeout(function(){c("#del-comment").click(),t.hide()},500)}},cancel:{label:"Отмена",className:"btn-default",callback:function(){}}}}),!1});var t=location.hash;-1!=t.indexOf("comment-")&&(c(t).addClass("showed"),setTimeout(function(){c(t).removeClass("showed")},1e3))}(jQuery)});