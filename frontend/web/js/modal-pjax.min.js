ModalPjax=function(t){this.options=$.extend({},{url:"",pjaxId:"",title:"",className:"",buttons:{}},t),this.normalizeButtons()},ModalPjax.prototype.normalizeButtons=function(){var t;if("object"!=typeof(t=this.options.buttons))throw new Error("Please supply an object of buttons");void 0===t.cancel&&(t.cancel={label:"Отмена",className:"btn-default"}),$.each(t,function(t,o){if("object"!==$.type(o))throw new Error("button with key "+t+" must be an object");if(o.label||(o.label=t),o.className||(o.className="btn-default"),o.callback&&!$.isFunction(o.callback))throw new Error("button.callback must be a function")})},ModalPjax.prototype.open=function(){var t=this.render();this.$modal=t,$("body").append(t);var o={container:"#"+this.options.pjaxId,push:!1,replace:!1,history:!1,timeout:1e4,scrollTo:!1};$.pjax($.extend({},o,{url:this.options.url})),this.registerEvents(t),this.registerPjaxEvents(t,o),$.isFunction(this.options.beforeShow)&&this.options.beforeShow.call(this),t.modal()},ModalPjax.prototype.hide=function(){this.$modal.modal("hide")},ModalPjax.prototype.setUrl=function(t){this.options.url=t},ModalPjax.prototype.render=function(){var t=$('<div class="modal modal-pjax '+this.options.className+' fade" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"></div><div class="modal-body"></div><div class="modal-footer"></div></div></div></div>'),o=this.headerRender();t.find(".modal-header").append(o);var a=this.bodyRender();t.find(".modal-body").append(a);var e=this.footerRender();return t.find(".modal-footer").append(e),t},ModalPjax.prototype.headerRender=function(){return $('<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+this.options.title+"</h4>")},ModalPjax.prototype.bodyRender=function(){return $('<div id="'+this.options.pjaxId+'"></div>')},ModalPjax.prototype.footerRender=function(){var t,a;return t=this.options.buttons,a="",$.each(t,function(t,o){a+="<button data-mp-handler='"+t+"' type='button' class='btn "+o.className+"'>"+o.label+"</button>"}),$(a)},ModalPjax.prototype.registerEvents=function(o){var n=this;o.on("hidden.bs.modal",function(t){t.target===this&&o.remove()}),o.on("click",".modal-footer button",function(t){var o=$(this).data("mp-handler"),a=n.options.buttons;if(void 0!==a[o]){var e=a[o];(!e.callback||!1!==e.callback.call(n))&&n.hide()}})},ModalPjax.prototype.registerPjaxEvents=function(t,o){t.pjax("#"+this.options.pjaxId+" a",o),t.on("submit","#"+this.options.pjaxId+" form[data-pjax]",function(t){$.pjax.submit(t,o)})};